<p class="center"><img src="/img/taSk/taSkHome.png" alt="" /></p>

<h3 class="wide">Explanation</h3>

<p>This application aims to mange to-do list by automatically removing  to-do items older than seven days. Items older than seven days are considered unimportant and should not be on your to-do list.</p>

<h3 class="wide">Problem</h3>

<p>This project was meant to expand upon backend knowledge and skills, particularly Ruby on Rails. Primary object objective was for me to meet all of the predefined user requirements.</p>

<h3 class="wide">User Requirements</h3>
<ol>
  <li>Allow user to sign up for a free account by providing a user name, password and email</li>
  <li>Allow users to sign in and out of taSk!</li>
  <li>Allow users to see my profile page</li>
  <li>Allow users to create multiple to-do items</li>
  <li>Allow users to mark to-do items as complete and have them deleted</li>
  <li>Allow users to see how old a to-do item is</li>
  <li>Users to-dos should be automatically deleted seven days after their creation date</li>
</ol>

<h3 class="wide">Solution</h3>
<p>To start the project a new Rails app was generated. I then configured git and Github for collaboration. Next I configured the default gems for my project. To make styling the application easier I added Bootstrap. The aforementioned steps are the initial steps for every project of course.</p>

<p>Once the foundation for the app was laid I incorporated Devise for authentication. This step involved generating a Devise User model.</p>
<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>rails g devise user
</code></pre></div></div>

<p>Rails generated a migration file as a result. To run the migrations I executed the following:</p>
<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Rake db:migrate
</code></pre></div></div>
<p>This allowed users to sign up for the application and send emails for confirmation.</p>

<p><img src="/img/taSk/signUp.png" alt="Sign In" /></p>

<p>For sign-in sign-out capabilities I used the Devise helper method <strong>user_signed_in?</strong> which determined if a user was signed in and rendered a particular view based on the response.</p>

<p>The navigation links Edit Profile and Sign Out indicated a user was signed in.</p>

<p><img src="/img/taSk/taskList.png" alt="Signed In" /></p>

<p>The user saw Sign-up or Sign In navigation links if not signed in.</p>

<p><img src="/img/taSk/signUp.png" alt="Sign Up" /></p>

<p>To redirect users that are not signed in to the login page   I used the Devise filter method.</p>

<p><span style="color:grey">app/controllers/application_controller.rb</span></p>

<figure class="highlight"><pre><code class="language-ruby" data-lang="ruby"><span class="n">before_action</span> <span class="ss">:authenticate_user!</span></code></pre></figure>

<p>To allow signed-in users to see their profile page I generated a UsersController which included a #show action.  To redirect the user to their show view after sign-in I updated the root path in routes.rb to map to the users show view.</p>

<p><span style="color:grey"><strong>config/routes.rb</strong></span></p>

<figure class="highlight"><pre><code class="language-ruby" data-lang="ruby"><span class="o">...</span>
  <span class="n">authenticated</span> <span class="ss">:user</span> <span class="k">do</span>
      <span class="n">root</span> <span class="s1">'users#show'</span><span class="p">,</span> <span class="ss">as: :authenticated_root</span>
  <span class="k">end</span>
<span class="o">...</span></code></pre></figure>

<p><br /></p>

<p>My next task was to allow a user to create multiple to-do items. An Item model that references a user was generated to address this need. The items controller included only <span style="color:red">C</span>reate and <span style="color:red">D</span>estroy <span style="color:red">CRUD</span> actions.</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>$ rails g model Item name:string user:references
</code></pre></div></div>

<p>By referencing the User model a <strong>belongs_to :user</strong> relationship was created on the Item model.</p>

<p><span style="color:grey"><strong>app/models/item.rb</strong></span></p>

<figure class="highlight"><pre><code class="language-ruby" data-lang="ruby"><span class="o">...</span>

  <span class="n">belongs_to</span> <span class="ss">:user</span>
<span class="o">...</span></code></pre></figure>

<p>An <strong>has_many :items</strong> relationship was established on the <strong>User</strong> model.</p>

<p><span style="color:grey"><strong>app/models/user.rb</strong></span></p>

<figure class="highlight"><pre><code class="language-ruby" data-lang="ruby"><span class="o">...</span>
  <span class="n">has_many</span> <span class="ss">:items</span><span class="p">,</span> <span class="ss">dependent: :destroy</span>
<span class="o">...</span></code></pre></figure>

<p>Next I generated an items controller with a #create action and ensured that it was associated with a user. I created a form partial in items directory which renders the form allowing users to submit new items. I created a partial named _item.html.erb in the times directory to show the body of each item associated with a user. Because the items partial renders a single item it was necessary to call it multiple times to render the partial for each item. I implemented an each loop to resolve that. <span style="color:red">D</span>on’t<span style="color:red">R</span>epeat<span style="color:red">Y</span>ourself!</p>

<p><img src="/img/taSk/fullListNoLogo.png" alt="User Show As Root" /></p>

<p>My next focus was allowing users to mark items as complete and have them removed immediately. To do so I used a <strong>:delete</strong>  link to complete a to-do item.</p>

<p><span style="color:grey"><strong>app/views/items/_item.html.erb</strong></span></p>

<figure class="highlight"><pre><code class="language-erb" data-lang="erb"><span class="cp">&lt;%=</span> <span class="n">link_to</span> <span class="s2">""</span><span class="p">,</span> <span class="n">item</span><span class="p">,</span> <span class="ss">method: :delete</span><span class="p">,</span> <span class="ss">class: </span><span class="s1">'btn btn-danger'</span><span class="p">,</span> <span class="ss">autofoucs: </span><span class="kp">true</span> <span class="cp">%&gt;</span></code></pre></figure>

<p>I used Bootstrap’s button class that create a custom *delete** button that links to the #delete action. Ajax was used to delete to-do items without reloading the page .</p>

<p>This app is all about time frames. SO to display the time remaining on a to-do item before it was automatically deleted I used a Rails helper method called <strong>distance_of_time_in_words</strong> which displays the number of days since an item was generated.</p>

<p><span style="color:grey"><strong>app/views/items/_item.html.erb</strong></span></p>

<figure class="highlight"><pre><code class="language-erb" data-lang="erb">...

  <span class="cp">&lt;%=</span> <span class="n">distance_of_time_in_words</span><span class="p">(</span><span class="no">Time</span><span class="p">.</span><span class="nf">now</span><span class="p">,</span> <span class="n">item</span><span class="p">.</span><span class="nf">created_at</span> <span class="o">+</span> <span class="mi">7</span><span class="p">.</span><span class="nf">days</span> <span class="p">)</span> <span class="cp">%&gt;</span> left <span class="nt">&lt;br&gt;</span>

...</code></pre></figure>

<p>In order to automatically delete expired to-do items I used the <em>Rake</em> utility. It is used to automate administrative tasks in <strong>Rails</strong> apps. Building a custom task was necessary to accomplish what was needed. I used the Rails task generator to generate the new task from the terminal.</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>$ rails g task todo delete_items
</code></pre></div></div>
<p>The above command created the file lib/tasks/todo.rake. The file included the following:</p>

<p><span style="color:grey"><strong>lib/tasks/todo.rake</strong></span></p>

<figure class="highlight"><pre><code class="language-ruby" data-lang="ruby"><span class="n">namespace</span> <span class="ss">:todo</span> <span class="k">do</span>
  <span class="n">desc</span> <span class="s2">"TODO"</span>
  <span class="n">task</span> <span class="ss">delete_items: :environment</span> <span class="k">do</span>
  <span class="k">end</span>

<span class="k">end</span></code></pre></figure>

<p><strong>namespace :todo</strong> organized new tasks under the <strong>todo</strong> namespace.
Task <strong>delete_items:</strong> defined new deleted_items tasks.
Desc “TODO” supplied documentation for a task.</p>

<p>To ensure items older than seven days were deleted I modified the created task.</p>

<p><span style="color:grey"><strong>lib/tasks/todo.rake</strong></span></p>

<figure class="highlight"><pre><code class="language-ruby" data-lang="ruby">   <span class="n">namespace</span> <span class="ss">:todo</span> <span class="k">do</span>
 <span class="o">-</span>   <span class="n">desc</span> <span class="s2">"TODO"</span>
 <span class="o">+</span>  <span class="n">desc</span> <span class="s2">"Delete items older than seven days"</span>
     <span class="n">task</span> <span class="ss">delete_items: :environment</span> <span class="k">do</span>
        <span class="no">Item</span><span class="p">.</span><span class="nf">where</span><span class="p">(</span><span class="s2">"created_at &lt;= ?"</span><span class="p">,</span> <span class="no">Time</span><span class="p">.</span><span class="nf">now</span> <span class="o">-</span> <span class="mi">7</span><span class="p">.</span><span class="nf">days</span><span class="p">).</span><span class="nf">destroy_all</span>
    <span class="k">end</span>

 <span class="k">end</span></code></pre></figure>

<p>To run the Rake task and delete items older than seven days</p>
<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>rake todo:delete_items
</code></pre></div></div>

<h3 class="wide">Results</h3>
<p>All user requirements met and working as expected.</p>

<h3 class="wide">Conclusion</h3>

<p>I had fun with this project.  I have made several apps using Rails to this point. I cannot get enough of Rails. Incorporating rake was very interesting. I could have made the users show page private. I will do this knowing I would want this feature as a user. I could have implemented user authentication from scratch instead of using a gem. I could have automated delete Rake tasks to run daily.</p>

<h3 class="wide"> Post Completion Updates</h3>
<h4 class="wide">	 Added Features</h4>

<ol>
  <li><span class="strikethrough">Users show page private.</span></li>
  <li><span class="strikethrough">Automated delete Rake task to run daily.</span></li>
</ol>
