<!DOCTYPE html>
<html class="no-js">
  <head>
	<meta charset="utf-8">
	<title>DoUpedia | Tyrant Davis</title>
	<meta name="description" content="">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<meta http-equiv="X-Frame-Options" content="sameorigin">

	<!-- CSS -->
	<link rel="stylesheet" href="/css/main.css">

	<!--Favicon-->
	<link rel="shortcut icon" href="/favicon.ico" type="image/x-icon">

	<!-- Canonical -->
	<link rel="canonical" href="http://localhost:4000/portfolio/doupedia/">

	<!-- RSS -->
	<link rel="alternate" type="application/atom+xml" title="Tyrant Davis" href="http://localhost:4000/feed.xml" />

	<!-- Font Awesome -->
	<link href="//maxcdn.bootstrapcdn.com/font-awesome/4.3.0/css/font-awesome.min.css" rel="stylesheet">

	<!-- Google Fonts -->
	
	<link href="//fonts.googleapis.com/css?family=Lato:300,400,700,300italic,700italic|Abril+Fatface" rel="stylesheet" type="text/css">
	

	<!-- KaTeX -->
	
	<link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/KaTeX/0.3.0/katex.min.css">
	<script src="//cdnjs.cloudflare.com/ajax/libs/KaTeX/0.3.0/katex.min.js"></script>
	

	<!-- Google Analytics -->
	
	<script>
	(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
	(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
	m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
	})(window,document,'script','//www.google-analytics.com/analytics.js','ga');

	ga('create', 'UA-113296559-1', 'auto');
	ga('send', 'pageview');
	</script>
	
</head>

  <body>
    <header class="site-header">
  <nav class="site-nav">
    <ul>
      
      
      <li>
        <a class="page-link" href="/donate.html">
          Donations Page <!-- Renders About and Say Hello links on post and portfolio pages plu about & say hello pages-->
        </a>
      </li>
      
      
      
      <li>
        <a class="page-link" href="/">
          home <!-- Renders About and Say Hello links on post and portfolio pages plu about & say hello pages-->
        </a>
      </li>
      
      
      
      
    </ul>
  </nav>

  
  <div class="call-out"
  style="background-image: url('/')">
    <h1 class="site-title">
      <a href="/">Tyrant Davis</a>
    </h1>
    <div class="divider"></div>
    <h1 class="title">DoUpedia</h1> <!-- Post and Portfolio Big titles beneath Tyrant Davis i.e. Challenge Accepted! -->
  </div>
  
</header>

    <div class="content">
      <article class="w3-container">
  <section class="post-conten w3-center"><p class="center"><img src="/img/home.png" alt="" /></p>

<h3 class="wide">Explanation</h3>

<p>DoUpedia is a CRUD application built using Ruby on Rails. This build uses some helpful gems including Stripe, Devise, Pundit, Redcarpet, and Faker.</p>

<h3 class="wide">Problem</h3>

<p>The aim for this project was to further my backend knowledge and skills of Ruby on Rails and gain greater exposure to some fantastic Ruby gems. Another objective was for me to meet all of the predefined user requirements.</p>

<h3 class="wide">Objectives</h3>

<ul>
  <li>Create basic Rails user scheme</li>
  <li>Giver user the ability to sign up for app using Devise</li>
  <li>Create CRUD routes and resources for Rails app</li>
  <li>Authenticate and authorize users</li>
  <li>Integrate Stripe for payments</li>
  <li>Integrate Redcarpet Markdown gem for rendering</li>
</ul>

<h3 class="wide">User Requirements</h3>

<ol>
  <li>Allow users to sign up for a free account by providing a user name, password and email</li>
  <li>Allow users to sign in and out of DoUpedia</li>
  <li>Allow users with a standard account to create, read, update, and delete public wikis</li>
  <li>Provide three user roles: admin, standard, or premium</li>
  <li>Allow user to upgrade account from a free to a paid plan</li>
  <li>Allow premium user to create private wikis</li>
  <li>Allow user to edit wikis using Markdown syntax</li>
  <li>Allow premium user to add and remove collaborators for my private wikis</li>
</ol>

<h3 class="wide">Solution</h3>

<p>The initial stages of the app involved generating a new Rails app, configuring git and Github for collaboration, and adding default gems for the project.</p>

<figure class="highlight"><pre><code class="language-ruby" data-lang="ruby"><span class="err">$</span> <span class="n">rails</span> <span class="n">_4</span><span class="o">.</span><span class="mf">2.5</span><span class="n">_</span> <span class="n">new</span> <span class="n">new</span><span class="o">-</span><span class="n">rails</span><span class="o">-</span><span class="n">project</span> <span class="err">â€”</span><span class="n">skip</span><span class="o">-</span><span class="nb">test</span><span class="o">-</span><span class="n">unit</span>
<span class="err">$</span> <span class="n">cd</span> <span class="n">new</span><span class="o">-</span><span class="n">rails</span><span class="o">-</span><span class="n">project</span></code></pre></figure>

<p>I generated a Welcome controller and related views, using HTML and CSS from there. This gave users a landing page to welcome them to the app. I created an index view which indexed all blocmarks for all to see, including those just visiting the site. A creative and playful <strong>call to action</strong> was included to grab the users attention. It also guides the user to the unusually placed pagination just below.</p>

<p><img src="/img/index.png" alt="DoUpedia Index" /></p>

<p>To sign users up for the app I added user authentication by incorporating Devise. I then created a Devise User model.</p>

<figure class="highlight"><pre><code class="language-ruby" data-lang="ruby"><span class="err">$</span> <span class="n">rails</span> <span class="n">g</span> <span class="n">devise</span> <span class="n">user</span></code></pre></figure>

<p><img src="/img/signup.png" alt="DoUpedia Signup" /></p>

<p><em>Sendgrid</em> was integrated into the app which allowed the app to send confirmation emails. To securely configure Sendgrid username and password the <em>Figaro</em> gem was used. I find myself using this gem quite a bit.</p>

<p><img src="/img/figaro.png" alt="Figaro Logo" /></p>

<p>For sign-in sign-out capabilities I used the <em>Devise</em> helper method <code class="highlighter-rouge">user_signed_in?</code> which determined if a user was signed in and rendered a particular view based on the response. The navigation links <strong>Edit Profile</strong> and <strong>Sign Out</strong> indicated a user was signed in. The user would see the <strong>Sign-up</strong> or <strong>Sign In</strong> navigation links if not signed in.</p>

<p><img src="/img/login.png" alt="DoUpedia Login" /></p>

<p>I generated a wiki model that references the user, plus a controller, and views for the resource. It enabled users to <span style="color: red">Create</span>, <span style="color: red">Read</span>, <span style="color: red">Update</span>, and <span style="color: red">Delete</span> public wikis.</p>

<p><em>Faker</em> was used to seed the database.</p>

<p><img src="/img/entry.png" alt="DoUpedia Wiki" /></p>

<figure class="highlight"><pre><code class="language-ruby" data-lang="ruby"><span class="err">$</span> <span class="n">rails</span> <span class="n">g</span> <span class="n">model</span> <span class="no">Wiki</span> <span class="n">title</span><span class="ss">:string</span> <span class="n">body</span><span class="ss">:text</span> <span class="kp">private</span><span class="ss">:boolean</span> <span class="n">user</span><span class="ss">:references:index</span></code></pre></figure>

<p><em>Pundit</em>  was used for authorization. I defined three user roles: <strong>standard, premium, admin</strong> using an <strong><em>enum</em></strong> attribute on the User model. The <code class="highlighter-rouge">before_save</code> callback implemented standard as the default value for users.</p>

<figure class="highlight"><pre><code class="language-ruby" data-lang="ruby"><span class="n">app</span><span class="o">/</span><span class="n">models</span><span class="o">/</span><span class="n">user</span><span class="p">.</span><span class="nf">rb</span>
<span class="o">...</span>
<span class="n">before_save</span> <span class="p">{</span> <span class="nb">self</span><span class="p">.</span><span class="nf">role</span> <span class="o">||=</span> <span class="ss">:standard</span> <span class="p">}</span>
<span class="o">...</span>
<span class="n">enum</span> <span class="ss">role: </span><span class="p">[</span><span class="ss">:standard</span><span class="p">,</span> <span class="ss">:premium</span><span class="p">,</span> <span class="ss">:admin</span><span class="p">]</span>
<span class="o">...</span></code></pre></figure>

<p>For this project I wanted to allow users to edit any public wiki unlike Bloccit where the user had to be an admin. To do so the <strong>#update</strong> method for application policy was modified to:</p>

<figure class="highlight"><pre><code class="language-ruby" data-lang="ruby"><span class="n">app</span><span class="o">/</span><span class="n">policies</span><span class="o">/</span><span class="n">application_policy</span><span class="p">.</span><span class="nf">rb</span>

  <span class="k">def</span> <span class="nf">update?</span>
    <span class="n">user</span><span class="p">.</span><span class="nf">present?</span> <span class="o">&amp;&amp;</span><span class="p">(</span> <span class="p">(</span><span class="n">record</span><span class="p">.</span><span class="nf">user</span> <span class="o">==</span> <span class="n">user</span><span class="p">)</span> <span class="o">||</span> <span class="n">user</span><span class="p">.</span><span class="nf">admin?</span> <span class="p">)</span>
  <span class="k">end</span>
    </code></pre></figure>

<p>An inner Scope class was added to the <em>wiki_policy</em> to regulate which wikis populated on the index page. The scope was then used to modify the <strong>#index</strong> action in the wikis_controller to show the right wikis and limit the # of wikis shown per page.</p>

<figure class="highlight"><pre><code class="language-ruby" data-lang="ruby"><span class="k">def</span> <span class="nf">index</span>
  <span class="vi">@wikis</span> <span class="o">=</span> <span class="n">policy_scope</span><span class="p">(</span><span class="no">Wiki</span><span class="p">).</span><span class="nf">paginate</span><span class="p">(</span><span class="ss">page: </span><span class="n">params</span><span class="p">[</span><span class="ss">:page</span><span class="p">],</span> <span class="ss">per_page: </span><span class="mi">6</span><span class="p">)</span>
<span class="k">end</span>  
   </code></pre></figure>

<p><em>Stripe</em> was later integrated for payment processing. This feature was necessary to allow users a path to upgrading to a premium account. A ChargesController was generated with a <strong>#create</strong> action and a <strong>#new</strong>. This controller initializes and then creates Charge objects after receiving <strong><code class="highlighter-rouge">params: stripeToken</code></strong> and <strong><code class="highlighter-rouge">amount</code></strong> , ultimately sending them through Stripes API to complete the transaction. I also designed a user flow for down grading or reverting back to a standard account.</p>

<p>I implemented some privacy controls on wikis to manage private wikis. Controls checked to see if the users role was admin or  premium  before allowing a private wiki to be edited. The control included in wikis partial  ` app/views/wikis/ _form.html.erb ` presented a checkbox only viewable by premium users or an admin.</p>

<p><em>Redacarpet</em> was integrated in order to parse Markdown syntax .</p>

<p>The last resource generated was the Collaborator. A collaborator model was built to allow users to add and remove collaborators from private wikis from the wikiâ€™s edit page. A relationship between wikis and users was established through the collaborators model by implementing a has many through relationship.</p>

<figure class="highlight"><pre><code class="language-ruby" data-lang="ruby"><span class="n">collaborator</span><span class="p">.</span><span class="nf">rb</span>

<span class="k">class</span> <span class="nc">Collaborator</span> <span class="o">&lt;</span> <span class="no">ActiveRecord</span><span class="o">::</span><span class="no">Base</span>
  <span class="n">belongs_to</span> <span class="ss">:user</span>
  <span class="n">belongs_to</span> <span class="ss">:wiki</span>
<span class="k">end</span></code></pre></figure>

<h3 class="wide">Results</h3>

<blockquote>
  <p>All user requirements met and working as expected.</p>
</blockquote>

<h3 class="wide">Conclusion</h3>

<p>I could have implemented authentication and authorization mechanisms from scratch which is unnecessary, but a very valuable learning tool. I could have generated the views for this app using HAML instead of ERB. I could have added a real-time Markdown editor for wikis.I am always looking to grow so these are definitely features to add to in the future or to future projects. This was a really fun project. Rails is incredible and I love it.</p>
</section>
</article>

<!-- Disqus -->
 
<!-- <p class="center"><img src="/img/home.png" alt="" /></p>

<h3 class="wide">Explanation</h3>

<p>DoUpedia is a CRUD application built using Ruby on Rails. This build uses some helpful gems including Stripe, Devise, Pundit, Redcarpet, and Faker.</p>

<h3 class="wide">Problem</h3>

<p>The aim for this project was to further my backend knowledge and skills of Ruby on Rails and gain greater exposure to some fantastic Ruby gems. Another objective was for me to meet all of the predefined user requirements.</p>

<h3 class="wide">Objectives</h3>

<ul>
  <li>Create basic Rails user scheme</li>
  <li>Giver user the ability to sign up for app using Devise</li>
  <li>Create CRUD routes and resources for Rails app</li>
  <li>Authenticate and authorize users</li>
  <li>Integrate Stripe for payments</li>
  <li>Integrate Redcarpet Markdown gem for rendering</li>
</ul>

<h3 class="wide">User Requirements</h3>

<ol>
  <li>Allow users to sign up for a free account by providing a user name, password and email</li>
  <li>Allow users to sign in and out of DoUpedia</li>
  <li>Allow users with a standard account to create, read, update, and delete public wikis</li>
  <li>Provide three user roles: admin, standard, or premium</li>
  <li>Allow user to upgrade account from a free to a paid plan</li>
  <li>Allow premium user to create private wikis</li>
  <li>Allow user to edit wikis using Markdown syntax</li>
  <li>Allow premium user to add and remove collaborators for my private wikis</li>
</ol>

<h3 class="wide">Solution</h3>

<p>The initial stages of the app involved generating a new Rails app, configuring git and Github for collaboration, and adding default gems for the project.</p>

<figure class="highlight"><pre><code class="language-ruby" data-lang="ruby"><span class="err">$</span> <span class="n">rails</span> <span class="n">_4</span><span class="o">.</span><span class="mf">2.5</span><span class="n">_</span> <span class="n">new</span> <span class="n">new</span><span class="o">-</span><span class="n">rails</span><span class="o">-</span><span class="n">project</span> <span class="err">â€”</span><span class="n">skip</span><span class="o">-</span><span class="nb">test</span><span class="o">-</span><span class="n">unit</span>
<span class="err">$</span> <span class="n">cd</span> <span class="n">new</span><span class="o">-</span><span class="n">rails</span><span class="o">-</span><span class="n">project</span></code></pre></figure>

<p>I generated a Welcome controller and related views, using HTML and CSS from there. This gave users a landing page to welcome them to the app. I created an index view which indexed all blocmarks for all to see, including those just visiting the site. A creative and playful <strong>call to action</strong> was included to grab the users attention. It also guides the user to the unusually placed pagination just below.</p>

<p><img src="/img/index.png" alt="DoUpedia Index" /></p>

<p>To sign users up for the app I added user authentication by incorporating Devise. I then created a Devise User model.</p>

<figure class="highlight"><pre><code class="language-ruby" data-lang="ruby"><span class="err">$</span> <span class="n">rails</span> <span class="n">g</span> <span class="n">devise</span> <span class="n">user</span></code></pre></figure>

<p><img src="/img/signup.png" alt="DoUpedia Signup" /></p>

<p><em>Sendgrid</em> was integrated into the app which allowed the app to send confirmation emails. To securely configure Sendgrid username and password the <em>Figaro</em> gem was used. I find myself using this gem quite a bit.</p>

<p><img src="/img/figaro.png" alt="Figaro Logo" /></p>

<p>For sign-in sign-out capabilities I used the <em>Devise</em> helper method <code class="highlighter-rouge">user_signed_in?</code> which determined if a user was signed in and rendered a particular view based on the response. The navigation links <strong>Edit Profile</strong> and <strong>Sign Out</strong> indicated a user was signed in. The user would see the <strong>Sign-up</strong> or <strong>Sign In</strong> navigation links if not signed in.</p>

<p><img src="/img/login.png" alt="DoUpedia Login" /></p>

<p>I generated a wiki model that references the user, plus a controller, and views for the resource. It enabled users to <span style="color: red">Create</span>, <span style="color: red">Read</span>, <span style="color: red">Update</span>, and <span style="color: red">Delete</span> public wikis.</p>

<p><em>Faker</em> was used to seed the database.</p>

<p><img src="/img/entry.png" alt="DoUpedia Wiki" /></p>

<figure class="highlight"><pre><code class="language-ruby" data-lang="ruby"><span class="err">$</span> <span class="n">rails</span> <span class="n">g</span> <span class="n">model</span> <span class="no">Wiki</span> <span class="n">title</span><span class="ss">:string</span> <span class="n">body</span><span class="ss">:text</span> <span class="kp">private</span><span class="ss">:boolean</span> <span class="n">user</span><span class="ss">:references:index</span></code></pre></figure>

<p><em>Pundit</em>  was used for authorization. I defined three user roles: <strong>standard, premium, admin</strong> using an <strong><em>enum</em></strong> attribute on the User model. The <code class="highlighter-rouge">before_save</code> callback implemented standard as the default value for users.</p>

<figure class="highlight"><pre><code class="language-ruby" data-lang="ruby"><span class="n">app</span><span class="o">/</span><span class="n">models</span><span class="o">/</span><span class="n">user</span><span class="p">.</span><span class="nf">rb</span>
<span class="o">...</span>
<span class="n">before_save</span> <span class="p">{</span> <span class="nb">self</span><span class="p">.</span><span class="nf">role</span> <span class="o">||=</span> <span class="ss">:standard</span> <span class="p">}</span>
<span class="o">...</span>
<span class="n">enum</span> <span class="ss">role: </span><span class="p">[</span><span class="ss">:standard</span><span class="p">,</span> <span class="ss">:premium</span><span class="p">,</span> <span class="ss">:admin</span><span class="p">]</span>
<span class="o">...</span></code></pre></figure>

<p>For this project I wanted to allow users to edit any public wiki unlike Bloccit where the user had to be an admin. To do so the <strong>#update</strong> method for application policy was modified to:</p>

<figure class="highlight"><pre><code class="language-ruby" data-lang="ruby"><span class="n">app</span><span class="o">/</span><span class="n">policies</span><span class="o">/</span><span class="n">application_policy</span><span class="p">.</span><span class="nf">rb</span>

  <span class="k">def</span> <span class="nf">update?</span>
    <span class="n">user</span><span class="p">.</span><span class="nf">present?</span> <span class="o">&amp;&amp;</span><span class="p">(</span> <span class="p">(</span><span class="n">record</span><span class="p">.</span><span class="nf">user</span> <span class="o">==</span> <span class="n">user</span><span class="p">)</span> <span class="o">||</span> <span class="n">user</span><span class="p">.</span><span class="nf">admin?</span> <span class="p">)</span>
  <span class="k">end</span>
    </code></pre></figure>

<p>An inner Scope class was added to the <em>wiki_policy</em> to regulate which wikis populated on the index page. The scope was then used to modify the <strong>#index</strong> action in the wikis_controller to show the right wikis and limit the # of wikis shown per page.</p>

<figure class="highlight"><pre><code class="language-ruby" data-lang="ruby"><span class="k">def</span> <span class="nf">index</span>
  <span class="vi">@wikis</span> <span class="o">=</span> <span class="n">policy_scope</span><span class="p">(</span><span class="no">Wiki</span><span class="p">).</span><span class="nf">paginate</span><span class="p">(</span><span class="ss">page: </span><span class="n">params</span><span class="p">[</span><span class="ss">:page</span><span class="p">],</span> <span class="ss">per_page: </span><span class="mi">6</span><span class="p">)</span>
<span class="k">end</span>  
   </code></pre></figure>

<p><em>Stripe</em> was later integrated for payment processing. This feature was necessary to allow users a path to upgrading to a premium account. A ChargesController was generated with a <strong>#create</strong> action and a <strong>#new</strong>. This controller initializes and then creates Charge objects after receiving <strong><code class="highlighter-rouge">params: stripeToken</code></strong> and <strong><code class="highlighter-rouge">amount</code></strong> , ultimately sending them through Stripes API to complete the transaction. I also designed a user flow for down grading or reverting back to a standard account.</p>

<p>I implemented some privacy controls on wikis to manage private wikis. Controls checked to see if the users role was admin or  premium  before allowing a private wiki to be edited. The control included in wikis partial  ` app/views/wikis/ _form.html.erb ` presented a checkbox only viewable by premium users or an admin.</p>

<p><em>Redacarpet</em> was integrated in order to parse Markdown syntax .</p>

<p>The last resource generated was the Collaborator. A collaborator model was built to allow users to add and remove collaborators from private wikis from the wikiâ€™s edit page. A relationship between wikis and users was established through the collaborators model by implementing a has many through relationship.</p>

<figure class="highlight"><pre><code class="language-ruby" data-lang="ruby"><span class="n">collaborator</span><span class="p">.</span><span class="nf">rb</span>

<span class="k">class</span> <span class="nc">Collaborator</span> <span class="o">&lt;</span> <span class="no">ActiveRecord</span><span class="o">::</span><span class="no">Base</span>
  <span class="n">belongs_to</span> <span class="ss">:user</span>
  <span class="n">belongs_to</span> <span class="ss">:wiki</span>
<span class="k">end</span></code></pre></figure>

<h3 class="wide">Results</h3>

<blockquote>
  <p>All user requirements met and working as expected.</p>
</blockquote>

<h3 class="wide">Conclusion</h3>

<p>I could have implemented authentication and authorization mechanisms from scratch which is unnecessary, but a very valuable learning tool. I could have generated the views for this app using HAML instead of ERB. I could have added a real-time Markdown editor for wikis.I am always looking to grow so these are definitely features to add to in the future or to future projects. This was a really fun project. Rails is incredible and I love it.</p>

 <ul class="myposts">
 
     <li><a href="/2018/04/04/challenge-accepted.html">Challenge Accepted!!</a>
     <span class="postDate">Apr 4, 2018</span>
     </li>
 
     <li><a href="/2018/03/26/engineering-a-better-world.html">Engineering A Better World</a>
     <span class="postDate">Mar 26, 2018</span>
     </li>
 
     <li><a href="/2018/03/22/why-i-chose-software-architecture.html">Why I Chose Software Architecture</a>
     <span class="postDate">Mar 22, 2018</span>
     </li>
 
 </ul> -->

    </div>
    
<footer class="w3-container w3-padding-16 w3-cyan">
  <p class="w3-center w3-text-yellow w3-wide">Brought To You By: <b class="w3-text-night">The Night Life</b>
</p>
  <p class="w3-center w3-text-yellow">Powered by <a href="http://jekyllrb.com">Jekyll</a>.
</p>
</footer>


  </body>
</html>
